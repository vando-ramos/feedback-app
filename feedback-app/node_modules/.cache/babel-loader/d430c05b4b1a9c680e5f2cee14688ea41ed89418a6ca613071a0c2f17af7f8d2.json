{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { reactive } from 'vue';\nimport { useRouter } from 'vue-router';\nimport { useField } from 'vee-validate';\nimport { useToast } from 'vue-toastification';\nimport useModal from '../../hooks/useModal';\nimport icon from '../icon';\nimport { validateEmptyAndLength3, validateEmptyAndEmail } from '../../utils/validators';\nimport services from '../../services';\nexport default {\n  components: {\n    icon\n  },\n  setup() {\n    const router = useRouter();\n    const modal = useModal();\n    const toast = useToast();\n    const {\n      value: nameValue,\n      errorMessage: nameErrorMessage\n    } = useField('name', validateEmptyAndLength3);\n    const {\n      value: emailValue,\n      errorMessage: emailErrorMessage\n    } = useField('email', validateEmptyAndEmail);\n    const {\n      value: passwordValue,\n      errorMessage: passwordErrorMessage\n    } = useField('password', validateEmptyAndLength3);\n    const state = reactive({\n      hasErrors: false,\n      isLoading: false,\n      name: {\n        value: nameValue,\n        errorMessage: nameErrorMessage\n      },\n      email: {\n        value: emailValue,\n        errorMessage: emailErrorMessage\n      },\n      password: {\n        value: passwordValue,\n        errorMessage: passwordErrorMessage\n      }\n    });\n    async function login({\n      email,\n      password\n    }) {\n      const {\n        data,\n        errors\n      } = await services.auth.login({\n        email,\n        password\n      });\n      if (!errors) {\n        window.localStorage.setItem('token', data.token);\n        router.push({\n          name: 'feedbacks'\n        });\n        modal.close();\n      }\n      state.isLoading = false;\n    }\n    async function handleSubmit() {\n      try {\n        toast.clear();\n        state.isLoading = true;\n        const {\n          data,\n          errors\n        } = await services.auth.register({\n          name: state.name.value,\n          email: state.email.value,\n          password: state.password.value\n        });\n        if (!errors) {\n          await login({\n            email: state.email.value,\n            password: state.password.value\n          });\n          return;\n        }\n        if (errors.status === 404) {\n          toast.error('Email not found!');\n        }\n        if (errors.status === 401) {\n          toast.error('Invalid email or password!');\n        }\n        if (errors.status === 400) {\n          toast.error('Login error!');\n        }\n        state.isLoading = false;\n      } catch (error) {\n        state.isLoading = false;\n        state.hasErrors = !!error;\n        toast.error('Login error!');\n      }\n    }\n    return {\n      state,\n      close: modal.close,\n      handleSubmit\n    };\n  }\n};","map":{"version":3,"names":["reactive","useRouter","useField","useToast","useModal","icon","validateEmptyAndLength3","validateEmptyAndEmail","services","components","setup","router","modal","toast","value","nameValue","errorMessage","nameErrorMessage","emailValue","emailErrorMessage","passwordValue","passwordErrorMessage","state","hasErrors","isLoading","name","email","password","login","data","errors","auth","window","localStorage","setItem","token","push","close","handleSubmit","clear","register","status","error"],"sources":["/home/vando/vue-br/feedback-app/src/components/modalSignup/index.vue"],"sourcesContent":["<template>\n  <div class=\"flex justify-between\">\n    <h1 class=\"text-4xl font-black text-gray-800\">\n      Sign up\n    </h1>\n\n    <button @click=\"close\" class=\"text-4xl text-gray-600 focus:outline-none\">\n      &times;\n    </button>\n  </div>\n\n  <div class=\"mt-16\">\n    <form @submit.prevent=\"handleSubmit\">\n      <label class=\"block\">\n        <span class=\"text-lg font-medium text-gray-800\">Name</span>\n        <input v-model=\"state.name.value\" type=\"text\" :class=\"{'border-brand-danger': !!state.name.errorMessage}\"\n          class=\"block w-full px-4 py-3 mt-1 text-lg bg-gray-100 border-2 border-transparent rounded\" placeholder=\"Enter your name\"\n        >\n        <span v-if=\"!!state.name.errorMessage\" class=\"block font-medium text-brand-danger\">\n          {{ state.name.errorMessage }}\n        </span>\n      </label>\n\n      <label class=\"block mt-9\">\n        <span class=\"text-lg font-medium text-gray-800\">Email</span>\n        <input v-model=\"state.email.value\" type=\"email\" :class=\"{'border-brand-danger': !!state.email.errorMessage}\"\n          class=\"block w-full px-4 py-3 mt-1 text-lg bg-gray-100 border-2 border-transparent rounded\" placeholder=\"email@email.com\"\n        >\n        <span v-if=\"!!state.email.errorMessage\" class=\"block font-medium text-brand-danger\">\n          {{ state.email.errorMessage }}\n        </span>\n      </label>\n\n      <label class=\"block mt-9\">\n        <span class=\"text-lg font-medium text-gray-800\">Password</span>\n        <input v-model=\"state.password.value\" type=\"password\" :class=\"{'border-brand-danger': !!state.email.errorMessage}\"\n          class=\"block w-full px-4 py-3 mt-1 text-lg bg-gray-100 border-2 border-transparent rounded\" placeholder=\"Enter Password\"\n        >\n        <span v-if=\"!!state.password.errorMessage\" class=\"block font-medium text-brand-danger\">\n          {{ state.password.errorMessage }}\n        </span>\n      </label>\n\n      <button :disabled=\"state.isLoading\" type=\"submit\" :class=\"{'opacity-50': state.isLoading}\"\n        class=\"px-8 py-3 mt-10 text-2xl font-bold text-white rounded-full bg-brand-main focus:outline-none transition-all duration-150\"\n      >\n        <icon v-if=\"state.isLoading\" name='loading' class=\"animate-spin\" />\n        <span v-else>Log in</span>\n      </button>\n    </form>\n  </div>\n</template>\n\n<script>\nimport { reactive } from 'vue'\nimport { useRouter } from 'vue-router'\nimport { useField } from 'vee-validate'\nimport { useToast } from 'vue-toastification'\nimport useModal from '../../hooks/useModal'\nimport icon from '../icon'\nimport { validateEmptyAndLength3, validateEmptyAndEmail } from '../../utils/validators'\nimport services from '../../services'\n\nexport default {\n  components: { icon },\n  setup () {\n    const router = useRouter()\n    const modal = useModal()\n    const toast = useToast()\n\n    const {\n      value: nameValue,\n      errorMessage: nameErrorMessage\n    } = useField('name', validateEmptyAndLength3)\n\n    const {\n      value: emailValue,\n      errorMessage: emailErrorMessage\n    } = useField('email', validateEmptyAndEmail)\n\n    const {\n      value: passwordValue,\n      errorMessage: passwordErrorMessage\n    } = useField('password', validateEmptyAndLength3)\n\n    const state = reactive({\n      hasErrors: false,\n      isLoading: false,\n      name: {\n        value: nameValue,\n        errorMessage: nameErrorMessage\n      },\n      email: {\n        value: emailValue,\n        errorMessage: emailErrorMessage\n      },\n      password: {\n        value: passwordValue,\n        errorMessage: passwordErrorMessage\n      }\n    })\n\n    async function login ({ email, password}) {\n      const { data, errors } = await services.auth.login({ email, password })\n      if (!errors) {\n          window.localStorage.setItem('token', data.token)\n          router.push({ name: 'feedbacks' })\n          modal.close()\n        }\n\n        state.isLoading = false\n    }\n\n    async function handleSubmit () {\n      try {\n        toast.clear()\n        state.isLoading = true\n        const { data, errors } = await services.auth.register({\n          name: state.name.value,\n          email: state.email.value,\n          password: state.password.value\n        })\n\n        if (!errors) {\n          await login({\n            email: state.email.value,\n            password: state.password.value\n          })\n          return\n        }\n\n        if (errors.status === 404) {\n          toast.error('Email not found!')\n        }\n\n        if (errors.status === 401) {\n          toast.error('Invalid email or password!')\n        }\n\n        if (errors.status === 400) {\n          toast.error('Login error!')\n        }\n\n        state.isLoading = false\n      } catch (error) {\n        state.isLoading = false\n        state.hasErrors = !!error\n        toast.error('Login error!')\n      }\n    }\n\n    return {\n      state,\n      close: modal.close,\n      handleSubmit\n    }\n  }\n}\n</script>\n"],"mappings":";AAsDA,SAASA,QAAO,QAAS,KAAI;AAC7B,SAASC,SAAQ,QAAS,YAAW;AACrC,SAASC,QAAO,QAAS,cAAa;AACtC,SAASC,QAAO,QAAS,oBAAmB;AAC5C,OAAOC,QAAO,MAAO,sBAAqB;AAC1C,OAAOC,IAAG,MAAO,SAAQ;AACzB,SAASC,uBAAuB,EAAEC,qBAAoB,QAAS,wBAAuB;AACtF,OAAOC,QAAO,MAAO,gBAAe;AAEpC,eAAe;EACbC,UAAU,EAAE;IAAEJ;EAAK,CAAC;EACpBK,KAAIA,CAAA,EAAK;IACP,MAAMC,MAAK,GAAIV,SAAS,CAAC;IACzB,MAAMW,KAAI,GAAIR,QAAQ,CAAC;IACvB,MAAMS,KAAI,GAAIV,QAAQ,CAAC;IAEvB,MAAM;MACJW,KAAK,EAAEC,SAAS;MAChBC,YAAY,EAAEC;IAChB,IAAIf,QAAQ,CAAC,MAAM,EAAEI,uBAAuB;IAE5C,MAAM;MACJQ,KAAK,EAAEI,UAAU;MACjBF,YAAY,EAAEG;IAChB,IAAIjB,QAAQ,CAAC,OAAO,EAAEK,qBAAqB;IAE3C,MAAM;MACJO,KAAK,EAAEM,aAAa;MACpBJ,YAAY,EAAEK;IAChB,IAAInB,QAAQ,CAAC,UAAU,EAAEI,uBAAuB;IAEhD,MAAMgB,KAAI,GAAItB,QAAQ,CAAC;MACrBuB,SAAS,EAAE,KAAK;MAChBC,SAAS,EAAE,KAAK;MAChBC,IAAI,EAAE;QACJX,KAAK,EAAEC,SAAS;QAChBC,YAAY,EAAEC;MAChB,CAAC;MACDS,KAAK,EAAE;QACLZ,KAAK,EAAEI,UAAU;QACjBF,YAAY,EAAEG;MAChB,CAAC;MACDQ,QAAQ,EAAE;QACRb,KAAK,EAAEM,aAAa;QACpBJ,YAAY,EAAEK;MAChB;IACF,CAAC;IAED,eAAeO,KAAIA,CAAG;MAAEF,KAAK;MAAEC;IAAQ,CAAC,EAAE;MACxC,MAAM;QAAEE,IAAI;QAAEC;MAAO,IAAI,MAAMtB,QAAQ,CAACuB,IAAI,CAACH,KAAK,CAAC;QAAEF,KAAK;QAAEC;MAAS,CAAC;MACtE,IAAI,CAACG,MAAM,EAAE;QACTE,MAAM,CAACC,YAAY,CAACC,OAAO,CAAC,OAAO,EAAEL,IAAI,CAACM,KAAK;QAC/CxB,MAAM,CAACyB,IAAI,CAAC;UAAEX,IAAI,EAAE;QAAY,CAAC;QACjCb,KAAK,CAACyB,KAAK,CAAC;MACd;MAEAf,KAAK,CAACE,SAAQ,GAAI,KAAI;IAC1B;IAEA,eAAec,YAAWA,CAAA,EAAK;MAC7B,IAAI;QACFzB,KAAK,CAAC0B,KAAK,CAAC;QACZjB,KAAK,CAACE,SAAQ,GAAI,IAAG;QACrB,MAAM;UAAEK,IAAI;UAAEC;QAAO,IAAI,MAAMtB,QAAQ,CAACuB,IAAI,CAACS,QAAQ,CAAC;UACpDf,IAAI,EAAEH,KAAK,CAACG,IAAI,CAACX,KAAK;UACtBY,KAAK,EAAEJ,KAAK,CAACI,KAAK,CAACZ,KAAK;UACxBa,QAAQ,EAAEL,KAAK,CAACK,QAAQ,CAACb;QAC3B,CAAC;QAED,IAAI,CAACgB,MAAM,EAAE;UACX,MAAMF,KAAK,CAAC;YACVF,KAAK,EAAEJ,KAAK,CAACI,KAAK,CAACZ,KAAK;YACxBa,QAAQ,EAAEL,KAAK,CAACK,QAAQ,CAACb;UAC3B,CAAC;UACD;QACF;QAEA,IAAIgB,MAAM,CAACW,MAAK,KAAM,GAAG,EAAE;UACzB5B,KAAK,CAAC6B,KAAK,CAAC,kBAAkB;QAChC;QAEA,IAAIZ,MAAM,CAACW,MAAK,KAAM,GAAG,EAAE;UACzB5B,KAAK,CAAC6B,KAAK,CAAC,4BAA4B;QAC1C;QAEA,IAAIZ,MAAM,CAACW,MAAK,KAAM,GAAG,EAAE;UACzB5B,KAAK,CAAC6B,KAAK,CAAC,cAAc;QAC5B;QAEApB,KAAK,CAACE,SAAQ,GAAI,KAAI;MACxB,EAAE,OAAOkB,KAAK,EAAE;QACdpB,KAAK,CAACE,SAAQ,GAAI,KAAI;QACtBF,KAAK,CAACC,SAAQ,GAAI,CAAC,CAACmB,KAAI;QACxB7B,KAAK,CAAC6B,KAAK,CAAC,cAAc;MAC5B;IACF;IAEA,OAAO;MACLpB,KAAK;MACLe,KAAK,EAAEzB,KAAK,CAACyB,KAAK;MAClBC;IACF;EACF;AACF"},"metadata":{},"sourceType":"module","externalDependencies":[]}